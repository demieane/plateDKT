function [ Nm,HW,LW,L,HX3,HY3 ] = pseudoMassDKT( ii,k,l23,l31,l12,y12,y31,x12,x31,Area,Hm,GGin,GGin2,xg,yg,IEN,x,y,Hx,Hy,SFm,C4,C5,C6,S4,S5,S6,Hxx,Hyy,HW)
%UNTITLED Summary of this function goes here
%   Detailed explanation goes here


xsi=SFm(ii,2);
eta=SFm(ii,3);

% xsi=xg(ii);
% eta=yg(ii);

LW=[1 xsi eta xsi*eta xsi^2 eta^2 xsi^2*eta eta^2*xsi xsi^3 eta^3];
L=[1 xsi eta xsi*eta xsi^2 eta^2];






%% %% Álternative mass formulation

LL=zeros(3,22);
LL(1,:)=[LW zeros(1,12)];
LL(2,:)=[zeros(1,10) L zeros(1,6)];
LL(3,:)=[ zeros(1,16) L];

% %%%%  è÷,èy
Hxx2(1,:)=[0 1 0 0 0 0 0 0 0];
Hxx2(2,:)=[0 0 0 0 1 0 0 0 0];
Hxx2(3,:)=[0 0 0 0 0 0 0 1 0];
Hxx2(4,:)=[0 0 0 -S4(1,k)*3/(2*l23(k)) (0.5*C4(1,k)^2-0.25*S4(1,k)^2) (0.5*C4(1,k)*S4(1,k)+0.25*S4(1,k)*C4(1,k)) S4(1,k)*3/(2*l23(k)) (0.5*C4(1,k)^2-0.25*S4(1,k)^2) (0.5*C4(1,k)*S4(1,k)+0.25*S4(1,k)*C4(1,k))];
Hxx2(5,:)=[S5(1,k)*3/(2*l31(k)) (0.5*C5(1,k)^2-0.25*S5(1,k)^2) (0.5*C5(1,k)*S5(1,k)-0.25*S5(1,k)*C5(1,k)) 0 0 0 -S5(1,k)*3/(2*l31(k)) (0.5*C5(1,k)^2-0.25*S5(1,k)^2) (0.5*C5(1,k)*S5(1,k)+0.25*S5(1,k)*C5(1,k))];
Hxx2(6,:)=[-S6(1,k)*3/(2*l12(k)) (0.5*C6(1,k)^2-0.25*S6(1,k)^2) (0.5*C6(1,k)*S6(1,k)+0.25*S6(1,k)*C6(1,k)) S6(1,k)*3/(2*l12(k)) (0.5*C6(1,k)^2-0.25*S6(1,k)^2) (0.5*C6(1,k)*S6(1,k)+0.25*S6(1,k)*C6(1,k)) 0 0 0];

Hyy2(1,:)=[0 0 1 0 0 0 0 0 0];
Hyy2(2,:)=[0 0 0 0 0 1 0 0 0];
Hyy2(3,:)=[0 0 0 0 0 0 0 0 1];
Hyy2(4,:)=[0 0 0 C4(1,k)*3/(2*l23(k)) (0.5*S4(1,k)*C4(1,k)+0.25*S4(1,k)*C4(1,k)) (0.5*S4(1,k)^2-0.25*C4(1,k)^2) -C4(1,k)*3/(2*l23(k)) (0.5*S4(1,k)*C4(1,k)+0.25*S4(1,k)*C4(1,k)) (0.5*S4(1,k)^2-0.25*C4(1,k)^2)];
Hyy2(5,:)=[-C5(1,k)*3/(2*l31(k)) (0.5*C5(1,k)*S5(1,k)+0.25*C5(1,k)*S5(1,k)) (0.5*S5(1,k)^2-0.25*C5(1,k)^2) 0 0 0 C5(1,k)*3/(2*l31(k)) (0.5*C5(1,k)*S5(1,k)+0.25*S5(1,k)*C5(1,k)) (0.5*S5(1,k)^2-0.25*C5(1,k)^2)];
Hyy2(6,:)=[C6(1,k)*3/(2*l12(k)) (0.5*C6(1,k)*S6(1,k)+0.25*S6(1,k)*C6(1,k)) (0.5*S6(1,k)^2-0.25*C6(1,k)^2) -C6(1,k)*3/(2*l12(k)) (0.5*C6(1,k)*S6(1,k)+0.25*S6(1,k)*C6(1,k)) (0.5*S6(1,k)^2-0.25*C6(1,k)^2) 0 0 0];

%%%%  â÷,ây
Hxx3(1,:)=[0 0 1 0 0 0 0 0 0];
Hxx3(2,:)=[0 0 0 0 0 1 0 0 0];
Hxx3(3,:)=[0 0 0 0 0 0 0 0 1];
Hxx3(4,:)=[0 0 0 -S4(1,k)*3/(2*l23(k)) -(0.5*C4(1,k)*S4(1,k)+0.25*S4(1,k)*C4(1,k))  (0.5*C4(1,k)^2-0.25*S4(1,k)^2) S4(1,k)*3/(2*l23(k)) -(0.5*C4(1,k)*S4(1,k)+0.25*S4(1,k)*C4(1,k)) (0.5*C4(1,k)^2-0.25*S4(1,k)^2) ];
Hxx3(5,:)=[S5(1,k)*3/(2*l31(k)) -(0.5*C5(1,k)*S5(1,k)+0.25*S5(1,k)*C5(1,k)) (0.5*C5(1,k)^2-0.25*S5(1,k)^2) 0 0 0 -S5(1,k)*3/(2*l31(k)) -(0.5*C5(1,k)*S5(1,k)+0.25*S5(1,k)*C5(1,k)) (0.5*C5(1,k)^2-0.25*S5(1,k)^2)];
Hxx3(6,:)=[-S6(1,k)*3/(2*l12(k)) -(0.5*C6(1,k)*S6(1,k)+0.25*S6(1,k)*C6(1,k)) (0.5*C6(1,k)^2-0.25*S6(1,k)^2)  S6(1,k)*3/(2*l12(k)) -(0.5*C6(1,k)*S6(1,k)+0.25*S6(1,k)*C6(1,k)) (0.5*C6(1,k)^2-0.25*S6(1,k)^2) 0 0 0];

Hyy3(1,:)=[0 -1 0 0 0 0 0 0 0];
Hyy3(2,:)=[0 0 0 0 -1 0 0 0 0];
Hyy3(3,:)=[0 0 0 0 0 0 0 -1 0];
Hyy3(4,:)=[0 0 0 C4(1,k)*3/(2*l23(k)) -(0.5*S4(1,k)^2-0.25*C4(1,k)^2) (0.5*S4(1,k)*C4(1,k)+0.25*S4(1,k)*C4(1,k)) -C4(1,k)*3/(2*l23(k)) -(0.5*S4(1,k)^2-0.25*C4(1,k)^2) (0.5*S4(1,k)*C4(1,k)+0.25*S4(1,k)*C4(1,k))];
Hyy3(5,:)=[-C5(1,k)*3/(2*l31(k)) -(0.5*S5(1,k)^2-0.25*C5(1,k)^2) (0.5*C5(1,k)*S5(1,k)+0.25*C5(1,k)*S5(1,k)) 0 0 0 C5(1,k)*3/(2*l31(k)) -(0.5*S5(1,k)^2-0.25*C5(1,k)^2) (0.5*C5(1,k)*S5(1,k)+0.25*S5(1,k)*C5(1,k))];
Hyy3(6,:)=[C6(1,k)*3/(2*l12(k)) -(0.5*S6(1,k)^2-0.25*C6(1,k)^2) (0.5*C6(1,k)*S6(1,k)+0.25*S6(1,k)*C6(1,k)) -C6(1,k)*3/(2*l12(k)) -(0.5*S6(1,k)^2-0.25*C6(1,k)^2) (0.5*C6(1,k)*S6(1,k)+0.25*S6(1,k)*C6(1,k)) 0 0 0];
% % %% %%%%%%%%%%%%%%%%%%%%%%%
% 
% % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
HX3=GGin2*Hxx3;
HY3=GGin2*Hyy3;
HX2=GGin2*Hxx2;
HY2=GGin2*Hyy2;
% 
% HH=[HW;HX;HY];
% %%
 HH=[HW;HX3;HY3];
 Nm1=LL*HH;

%% %%%%%%%%

Nm=LW*HW; 
 %Nm=[Nw;Hx;Hy];
end