function [ Hs ] = matrHS( k,C4,C5,C6,S4,S5,S6,axp,ayp,bxp,byp,asp,bsp,l23,l31,l12 )
%UNTITLED3 Summary of this function goes here
%   Detailed explanation goes here

%   Detailed explanation goes here
A=zeros(3,3);
A(1,1)=1+3/2*S4(1,k)*asp(1)-3/2*C4(1,k)*bsp(1);
A(1,2)=3/2*S4(1,k)*asp(2)-3/2*C4(1,k)*bsp(2);
A(1,3)=3/2*S4(1,k)*asp(3)-3/2*C4(1,k)*bsp(3);

A(2,1)=3/2*S5(1,k)*asp(1)-3/2*C5(1,k)*bsp(1);
A(2,2)=1+3/2*S5(1,k)*asp(2)-3/2*C5(1,k)*bsp(2);
A(2,3)=3/2*S5(1,k)*asp(3)-3/2*C5(1,k)*bsp(3);

A(3,1)=3/2*S6(1,k)*asp(1)-3/2*C6(1,k)*bsp(1);
A(3,2)=3/2*S6(1,k)*asp(2)-3/2*C6(1,k)*bsp(2);
A(3,3)=1+3/2*S6(1,k)*asp(3)-3/2*C6(1,k)*bsp(3);

L=zeros(3,9);
%%
L(1,2)=3/2*C4(1,k)*bxp(1)-3/2*S4(1,k)*axp(1);
L(1,3)=3/2*C4(1,k)*byp(1)-3/2*S4(1,k)*ayp(1);
L(1,4)=3/(2*l23(1,k));
L(1,5)=3/2*C4(1,k)*bxp(2)-3/2*S4(1,k)*axp(2)+1/4*S4(1,k);
L(1,6)=3/2*C4(1,k)*byp(2)-3/2*S4(1,k)*ayp(2)-1/4*C4(1,k);
L(1,7)=-3/(2*l23(1,k));
L(1,8)=3/2*C4(1,k)*bxp(3)-3/2*S4(1,k)*axp(3)+1/4*S4(1,k);
L(1,9)=3/2*C4(1,k)*byp(3)-3/2*S4(1,k)*ayp(3)-1/4*C4(1,k);
%%
L(2,1)=-3/(2*l31(1,k));
L(2,2)=3/2*C5(1,k)*bxp(1)-3/2*S5(1,k)*axp(1)+1/4*S5(1,k);
L(2,3)=3/2*C5(1,k)*byp(1)-3/2*S5(1,k)*ayp(1)-1/4*C5(1,k);

L(2,5)=3/2*C5(1,k)*bxp(2)-3/2*S5(1,k)*axp(2);
L(2,6)=3/2*C5(1,k)*byp(2)-3/2*S5(1,k)*ayp(2);
L(2,7)=3/(2*l31(1,k));
L(2,8)=3/2*C5(1,k)*bxp(3)-3/2*S5(1,k)*axp(3)+1/4*S5(1,k);
L(2,9)=3/2*C5(1,k)*byp(3)-3/2*S5(1,k)*ayp(3)-1/4*C5(1,k);
%%
L(3,1)=3/(2*l12(1,k));
L(3,2)=3/2*C6(1,k)*bxp(1)-3/2*S6(1,k)*axp(1)+1/4*S6(1,k);
L(3,3)=3/2*C6(1,k)*byp(1)-3/2*S6(1,k)*ayp(1)-1/4*C6(1,k);
L(3,4)=-3/(2*l12(1,k));
L(3,5)=3/2*C6(1,k)*bxp(2)-3/2*S6(1,k)*axp(2)+1/4*S6(1,k);
L(3,6)=3/2*C6(1,k)*byp(2)-3/2*S6(1,k)*ayp(2)-1/4*C6(1,k);
L(3,8)=3/2*C6(1,k)*bxp(3)-3/2*S6(1,k)*axp(3);
L(3,9)=3/2*C6(1,k)*byp(3)-3/2*S6(1,k)*ayp(3);


Hs=A\L;

end

